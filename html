<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Malla Curricular - Ingeniería en Prevención de Riesgos</title>
  <style>
    body {
      background-color: #d8f3dc; /* verde pastel */
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 20px;
    }

    h1 {
      text-align: center;
      color: #1b4332;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 10px;
    }

    .semester {
      background-color: #b7e4c7; /* verde pastel */
      border: 2px solid #40916c; /* verde pastel oscuro */
      padding: 10px;
      border-radius: 10px;
    }

    .semester h3 {
      text-align: center;
      margin-bottom: 10px;
      color: #1b4332;
    }

    .subject {
      background-color: #e9f5ec; /* verde pálido */
      border: 1px solid #74c69d; /* borde más oscuro */
      padding: 8px;
      border-radius: 5px;
      margin-bottom: 5px;
      cursor: pointer;
    }

    .subject.locked {
      background-color: #ccc;
      border-color: #999;
      color: #666;
      cursor: not-allowed;
    }

    .subject.completed {
      background-color: #cfe6f3; /* azul claro */
      border: 1px solid #5b9fcf; /* azul oscuro */
      color: #1c3d5a;
      text-decoration: line-through;
    }
  </style>
</head>
<body>
  <h1>Malla Curricular - Ingeniería en Prevención de Riesgos</h1>
  <div class="grid" id="malla">
    <!-- Semestres se generan vía JS -->
  </div>

  <script>
    const malla = {
      1: [
        "Matemáticas", "Taller integrado ABP", "Salud ocupacional", "Fundamentos de seg. Industrial", "Química", "Comunicación y aprendizaje", "Herramientas de ofimaticas"
      ],
      2: [
        "Matemática aplicada", "Protocolos MINSAL 1", "Seguridad industrial 1", "Riesgos en la Ind.Qca.", "Inglés 1", "Desarrollo personal"
      ],
      3: [
        "Física 1", "Lab. Higiene industrial 1", "Ergonomía 1", "Seguridad industrial 2", "Emergencias en la industria", "Inglés 2", "Cultura y sociedad"
      ],
      4: [
        "Protocolos MINSAL 2", "Lab. Higiene industrial 2", "Ergonomía 2", "Riesgos industriales", "Emergencias civiles", "Emprendimiento y empleabilidad", "Sustentabilidad y medioambiente"
      ],
      5: [
        "Procesos productivos 1", "Leyes laborales 1", "Física 2", "Elaboración de infor. Técnicos", "Leyes ambientales", "Inglés 3"
      ],
      6: [
        "Procesos productivos 2", "Leyes laborales 2", "Laboratorio de EPP", "Estadística y probabilidades", "Energías renovables", "Inglés 4", "Habilidades comunicativas"
      ],
      7: [
        "Interpretación de planos", "Sistemas de gestión SSO", "Ev. Proyectos de prevención", "Plan experto trabajo en terreno", "Control de riesgos ambientales"
      ],
      8: [
        "Sistemas de gestión integrado", "Proyecto integrado final", "Gestión hab. Directivas", "Sistemas de gestión ambiental", "Práct. Integrada competencias"
      ]
    };

    const dependencias = {
      "Salud ocupacional": ["Protocolos MINSAL 1"],
      "Protocolos MINSAL 1": ["Lab. Higiene industrial 1", "Ergonomía 1"],
      "Lab. Higiene industrial 1": ["Lab. Higiene industrial 2"],
      "Ergonomía 1": ["Ergonomía 2"],
      "Lab. Higiene industrial 2": ["Protocolos MINSAL 2"],
      "Ergonomía 2": ["Protocolos MINSAL 2"],

      "Fundamentos de seg. Industrial": ["Seguridad industrial 1"],
      "Seguridad industrial 1": ["Seguridad industrial 2"],
      "Seguridad industrial 2": ["Riesgos industriales"],

      "Química": ["Riesgos en la Ind.Qca."],
      "Riesgos en la Ind.Qca.": ["Emergencias en la industria"],
      "Emergencias en la industria": ["Emergencias civiles"],

      "Procesos productivos 1": ["Procesos productivos 2"],
      "Procesos productivos 2": ["Interpretación de planos"],

      "Leyes laborales 1": ["Leyes laborales 2"],
      "Sistemas de gestión SSO": ["Sistemas de gestión integrado"],

      "Leyes ambientales": ["Energías renovables"],
      "Energías renovables": ["Control de riesgos ambientales"],
      "Control de riesgos ambientales": ["Sistemas de gestión ambiental"]
    };

    const estado = {};

    function crearMalla() {
      const contenedor = document.getElementById("malla");
      for (let i = 1; i <= 8; i++) {
        const semestre = document.createElement("div");
        semestre.className = "semester";
        const titulo = document.createElement("h3");
        titulo.innerText = `Semestre ${i}`;
        semestre.appendChild(titulo);

        malla[i].forEach(materia => {
          const div = document.createElement("div");
          div.className = "subject";
          div.innerText = materia;
          div.dataset.nombre = materia;
          div.dataset.semestre = i;
          estado[materia] = {
            elemento: div,
            completado: false,
            bloqueado: i !== 1
          };
          if (i !== 1) div.classList.add("locked");
          div.addEventListener("click", () => toggleMateria(materia));
          semestre.appendChild(div);
        });

        contenedor.appendChild(semestre);
      }
    }

    function toggleMateria(nombre) {
      const data = estado[nombre];
      if (data.bloqueado) return;

      data.completado = !data.completado;
      data.elemento.classList.toggle("completed", data.completado);

      if (data.completado && dependencias[nombre]) {
        dependencias[nombre].forEach(dep => {
          if (estado[dep]) {
            estado[dep].bloqueado = false;
            estado[dep].elemento.classList.remove("locked");
          }
        });
      }

      desbloquearSemestre();
    }

    function desbloquearSemestre() {
      for (let i = 2; i <= 8; i++) {
        const materias = malla[i - 1];
        const todasCompletas = materias.every(m => estado[m].completado);
        if (todasCompletas) {
          malla[i].forEach(m => {
            if (estado[m].bloqueado) {
              estado[m].bloqueado = false;
              estado[m].elemento.classList.remove("locked");
            }
          });
        }
      }
    }

    crearMalla();
  </script>
</body>
</html>
